\begin{circuitikz}[american voltages]

\draw 
 (2.5,1) node[nigfete](mosL1){}
 (2.5,3) node[nigfete](mosH1){}
 (7,1) node[nigfete](mosL2){}
 (7,3) node[nigfete](mosH2){}
 node[coordinate](vplus) at (0,3) {}
 node[coordinate](vminus) at (0,1) {}
 
;


\draw 
    (vplus) to[american voltage source,v^=$v_i(t)$] (vminus)
    (2.5,2) to[short,*-] (2.8,2) to[R,-] (4.2,2) to[short,i^>=$i_L(t)$] (4.8,2) to[L,-] (6.2,2) to[short,-*] (7,2) 
    (mosH1.S) to (mosL1.D)   
    (mosH2.S) to (mosL2.D) 
    (vplus) to (0,4) to[short,-] (2.5,4) to (mosH1.D) 
    (mosL1.S) to[short,-*] (2.5,0)
    (mosL2.S) to[short,-*] (7,0) to ++(0,0) node[ground](GND){}
    (mosH2.D) to[short,-] (7,4)
    (7,4) to (9,4) to[R,*-] (9,2) to[short,i^>=$i_C(t)$] (9,1.5) to[C,-*] (9,0) to[short,-] (0,0) to (vminus)
    (9,4) to[short,,i^>=$i_o(t)$] (11,4) to (11,3.5) to[R,v^>=$v_o(t)$] (11,0.5) to (11,0) to[short,-] (9,0) 
    (9.2,1.25) to[open,v^>=$v_C(t)$] (9.2,0.25)
    (4.6,2) to[open,v_>=$v_L(t)$] (6.4,2)
;

\draw
    (11,4) to[short,*-] (13,4) to[R] (13,2) coordinate (RB1L) to[R] (13,0) coordinate (RB2L) to[short,-*] (11,0)
    (13,2) to[short,*-] (14.5,2) to[C,v^>=$v_{f1}(t)$] (14.5,0) to[short,-*] (13,0)
    (RB1L) to[open] ++(-0.6,1) coordinate (RB1LT)
    (RB2L) to[open] ++(-0.6,1) coordinate (RB2LT)
    
    (14,-4) node[op amp, xscale=-0.7, yscale=-0.7] (opamp) {}
    (opamp.+) -| (16.0,2) to[short,-*] (14.5,2) coordinate (CF1T)
    (opamp.-) to ++(0.5,0) to ++(0,-0.7) to ++(-2,0) coordinate (OPFB)
    (OPFB) -| (opamp.out)
    (opamp.out) to[R,*-] ++(-2,0) coordinate (RF2L) to[short] ++(0,0) coordinate (vcfilter) to[C,v_>=$v_{o,s}(t)$] ++(0,-1.5) to ++(0,0) node[ground](GND2){}
    (vcfilter) to[short,*-] ++(-2,0) 
    to ++(0,0.5) to ++(-1,0) to ++(0,-1) to ++(1,0) to ++(0,0.5) to[open] ++(-0.5,0) coordinate (ADC) to[open] ++(-0.5,0) coordinate (ADCout) 
    (CF1T) to[open] ++(-0.8,-1) coordinate (CF1TT)
    (RF2L) to[open] ++(1,0.5) coordinate (RF2LT)
    (RF2L) to[open] ++(0.8,-0.75) coordinate (CF2TT)
;

\draw[-latex]
    (ADCout) to ++(-1,0) coordinate (COMP)
;

\draw
(COMP) to[open] ++(-0.3,-1.3) coordinate (REF)
(COMP) to[open] ++(0.2,0.2) coordinate (COMP2)
(COMP) to[open] ++(-0.15,-0.6) coordinate (COMP3)
;

\draw[-latex]
    (REF) to ++(0,1)
;

\draw
    (REF) to[open] ++(0.5,0) rectangle ++(-1,-1)
    (REF) to[open] ++(0,-0.5) coordinate (REFC)
;

\draw
  (COMP) to[open] ++(-0.3,0) circle (0.3cm)
;
\draw[-latex]
    (COMP) to[open] ++(-0.6,0) to ++(-1,0)
;
\draw
    (COMP) to[open] ++(-1.6,0) coordinate (CLAW)
;
\draw
    (CLAW) to[open] ++(0,0.5) rectangle ++(-2,-1)
    (CLAW) to[open] ++(-1,0) coordinate (CLAW2)
    (CLAW) to[open] ++(-2,0) coordinate (CLAW3)
;

\draw[-latex]
    (CLAW3) to ++(-1,0)
;

\draw
    (CLAW3) to[open] ++(-1,0) coordinate (DPWM)
;

\draw
    (DPWM) to[open] ++(0,0.5) rectangle ++(-1.5,-1)
    (DPWM) to[open] ++(-0.75,0) coordinate (DPWM2)
    (DPWM) to[open] ++(-0.75,0.5) coordinate (DPWM3)
;

\draw[thick,-latex]
    (DPWM3) |- ++(2.5,1.5) coordinate(GDR1)
;
\draw
    (GDR1) to[open] ++(0,0.5) rectangle ++(1.5,-1)
    (GDR1) to[open] ++(0.75,0.2) coordinate (GDRC1) 
    (GDR1) to[open] ++(0.75,-0.2) coordinate (GDRC2) 
    (GDR1) to[open] ++(0.75,0.5) coordinate (GDRT1) 
    (GDR1) to[open] ++(-1.3,0.2) coordinate (GDRS1) 
;

\draw[thick,-latex]
    (GDRT1) to ++(0,1) coordinate(GDR2) 
;

\draw
    (GDRT1) to[open] ++(1.2,0.3) coordinate(GDRS2) 
;

\draw[latex-]
    (mosH1.G) to ++(-0.5,0) 
;

\draw[latex-]
    (mosL1.G) to ++(-0.5,0)  
;

\draw[latex-]
    (mosH2.G) to ++(-0.5,0) 
;

\draw[latex-]
    (mosL2.G) to ++(-0.5,0) 
;

\draw
    (ADC) to[open] ++(0.8,1) coordinate (RECRT)
;

\draw[dashed]
    (RECRT) rectangle ++(-9,-3.5) to[open] ++(1.3,0.3) coordinate (RECLB)
;

\draw 
    node(Lind) at (5.5,2.5){$L$}
    node(T1) at (2.8,3){$T_1$}
    node(GT1) at (1.4,3){$v_{GT1}$}
    node(T2) at (2.8,1){$T_2$}
    node(GT2) at (1.4,1){$v_{GT2}$}
    node(T4) at (7.3,3){$T_4$}
    node(GT4) at (5.9,3){$v_{GT4}$}
    node(T3) at (7.3,1){$T_3$}
    node(GT3) at (5.9,1){$v_{GT3}$}
    node(C1) at (8.3,0.75){$C$}
    node(R1) at (10.4,2){$R_L$}
    node(R2) at (3.5,2.5){$r_L$}
    node(R3) at (8.4,3){$r_{esr}$}
    node(AD) at (ADC){ADC}
    node(REF) at (REFC){REF}
    node(CLAW_T) at (CLAW2){Control Law}
    node(DPWM_T) at (DPWM2){DPWM}
    node(GDRC1_T) at (GDRC1){Gate}
    node(GDRC2_T) at (GDRC2){Drivers}
    node(GDR_s) at (GDRS1){$v_{cT1},...,v_{cT4}$}
    node(GDR_s2) at (GDRS2){$v_{GT1},...,v_{GT4}$}
    node(COMPPLUS) at (COMP2){\textbf{+}}
    node(COMPMINUS) at (COMP3){\textbf{-}}
    node(RECLB_T) at (RECLB){\emph{TMS320F28069}}
    node(RB1L_T) at (RB1LT){$R_{b1}$}
    node(RB2L_T) at (RB2LT){$R_{b2}$}
    node(CF1_T) at (CF1TT){$C_{f1}$}
    node(RF2_T) at (RF2LT){$R_{f2}$}
    node(CF2_T) at (CF2TT){$C_{f2}$}
;

\end{circuitikz}